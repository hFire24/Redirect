<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>Keep this open! Your goals</title>
    <link href="https://fonts.googleapis.com/css2?family=Barlow+Semi+Condensed:ital,wght@1,800&family=Barlow:ital,wght@1,900&display=swap" rel="stylesheet">
    <link href="style.css" rel="stylesheet" type="text/css" />
    <link rel="shortcut icon" href="icon-star.ico">
    <link rel="apple-touch-icon" href="apple-touch-icon.png">
  </head>
  <body>
    <div id='message' class='space'>Your current goals</div>
    <div id='best-results' class='space'>For best results, keep this page open during the day.<br>
    If you're done with a goal, press the key corresponding to that goal to hide it.<br>
    If you're struggling to do the next goal, <a href='struggle2.html' target='_blank'>click here.</a><br>
    To export your tasks, <a href='#exportArea' onclick='exportGoals()'>click here.</a></div>
    <div id='goals-list' class='two-list' style="width:95%; margin:auto;">
    </div>
    <div class='space'></div>
    <textarea id='exportArea' cols='50' rows='8'></textarea>
    <button onclick='exportGoals()'>Export</button> <button onclick='copyToClipboard()'>Copy</button>
    <script>
      var aHabits = [//{text:"Tackle your to-do list",link:"index.html",category:"active"},
      {text:"Do your homework",link:"homework.html",category:"active"},
      {text:"Deal with Purdue E-mails",link:"pass",category:"active"},
      {text:"*Learn Full Stack <span class='time'>(4 lessons)</span>",link:"https://skl.sh/38rV6DT",category:"active"},
      {text:"Gain social skills <span class='time'>(2 lessons)</span>",link:"https://skl.sh/37ueYoA",category:"passive"},
      {text:"Listen to General Conference <span class='time'>(15 minutes)</span>",link:"gcprogress.html",category:"passive"},
      //{text:"Digitize fifth journal <span class='time'>(1 page)</span>",link:"pass",category:"active"},
        //bHabits
      //{text:"Read the book <u>Atomic Habits</u> <span class='time'>(1 chapter)</span>",link:"https://read.amazon.com/",category:"active"},
      //{text:"Learn Rubik's Cube algorithms <span class='time'>(2 mintues)</span>",link:"https://www.rubiks.com/media/guides/RBL_solve_guide_CUBE_US_5.375x8.375in_AW_27Feb2020_VISUAL.pdf/",category:"active"},
      {text:"Play Duolingo <span class='time'>(1 lesson)</span>",link:"https://www.duolingo.com/",category:"active"},
      {text:"Relax/meditate <span class='time'>(1 session)</span>",link:"relax.html",category:"passive"},
      //{text:"Code some stuff in C# <span class='time'>(10 minutes)</span>",link:"pass",category:"active"},
      {text:"Play Elevate <span class='time'>(5 minutes)</span>",link:"pass",category:"active"},
      {text:"Read the Daily Verse",link:"dvprogress.html",category:"active"},
      //{text:"Play Stepmania on pad <span class='time'>(3 songs)</span>",link:"stepmania.html",category:"active"},
        //cHabits
      {text:"Play 100% Orange Juice <span class='time'>(1-2 games)</span>",link:"pass",category:"active"},
      //{text:"Play Sudoku (Medium) <span class='time'>(1 puzzle)</span>",link:"https://www.websudoku.com/",category:"active"},
      //{text:"Play Linkdoku <span class='time'>(3 puzzles)</span>",link:"pass",category:"active"},
      {text:"Play I Love Hue <span class='time'>(15 minutes)</span>",link:"pass",category:"active"},
      {text:"Play Minesweeper <span class='time'>(1 solve)</span>",link:"http://minesweeperonline.com/",category:"active"},
      //{text:"Play Smash Ultimate <span class='time'>(30 minutes)</span>",link:"pass",category:"active"},
      {text:"Play Pokemon Showdown! <span class='time'>(2-3 <span id='tier'></span> battles)</span>",link:"https://play.pokemonshowdown.com",category:"active"},
      {text:"Play Bloons Tower Defense 6 <span class='time'>(Infinity)</span>",link:"pass",category:"active"}
      //{text:"Watch Only Connect <span class='time'>(30 minutes)</span>",link:"https://www.youtube.com/playlist?list=PLrlSc8gCDlytPSFpUdu9Y64Sy5ijWUzd-",category:"passive"}];
      ];
      do {
        shuffle(aHabits);
      } while (aHabits[0].text !== "Do your homework" || aHabits[aHabits.length - 2].text !== "Deal with Purdue E-mails" || aHabits[aHabits.length - 1].text !== "Play Bloons Tower Defense 6 <span class='time'>(Infinity)</span>");
      //while (aHabits[0].text !== "Digitize fifth journal <span class='time'>(1 page)</span>");

      //cHabits = cHabits.slice(0,5);

      function shuffle(array) {
        for (var i = array.length - 1; i > 0; i--) {
          var j = Math.floor(Math.random() * i);
          var temp = array[i];
          array[i] = array[j];
          array[j] = temp;
        }
      }

      var parent = document.getElementById("goals-list");

      async function buildArray(array,offset)
      {
        for(var i = 0; i < array.length; i++)
        {
          var element = document.createElement("a");
          var letter = String.fromCharCode(65+offset+i);
          element.id = "habit-" + letter;
          element.classList.add("hfire-link");
          element.innerHTML = letter + ": " + array[i].text;
          if(array[i].link !== "pass")
          {
            element.href = array[i].link;
            element.target = "_blank";
          }
          parent.appendChild(element);
          //Creates a random background color for the element
          var x = Math.floor(Math.random() * 128);
          var y = Math.floor(Math.random() * 128);
          var z = Math.floor(Math.random() * 32) + 96;
          var bgColor = "rgb(" + x + "," + y + "," + z + ")";
          element = document.getElementById("habit-" + letter)
          element.style.backgroundColor = bgColor;
          console.log(array[i]);
          if(array[i].category === "passive")
            element.style.color = "#7BF";
        }
      }

      buildArray(aHabits,0);
      //buildArray(bHabits,aHabits.length);
      //buildArray(cHabits,aHabits.length + bHabits.length);

      if(document.getElementById("tier")) {
        var tiers = ["OU","UU","RU","NU","PU"];
        var d = new Date();
        switch(d.getDay()) {
          case 1:
            tier.innerHTML = "OU";
            break;
          case 2:
            tier.innerHTML = "UU";
            break;
          case 3:
            tier.innerHTML = "RU";
            break;
          case 4:
            tier.innerHTML = "NU";
            break;
          case 5:
            tier.innerHTML = "PU";
            break;
          default:
            tier.innerHTML = tiers[Math.floor(Math.random() * 5)];
        }
      }

      window.onbeforeunload = function() { return "Would you really like to leave this page?"; }
      window.onkeyup = function(){deleteText(event)};

      var deletedElements = [];

      function deleteText(id) {
        console.log(id.key.toUpperCase());
        //For potential future proofing
        if(document.getElementById("habit-" + id.key.toUpperCase()) === null)
          return;
        var toBeDisabled = document.getElementById("habit-" + id.key.toUpperCase());
        toBeDisabled.style.color = toBeDisabled.style.backgroundColor;
        toBeDisabled.removeAttribute("href");
        deletedElements.push(id.key);
        for(var i = 0; i < deletedElements.length - 1; i++) {
          if(deletedElements[i] === id.key) {
            deletedElements.pop();
            break;
          }
        }
        console.log(deletedElements);
        if(deletedElements.length === aHabits.length + bHabits.length + cHabits.length)
        {
          document.getElementById("message").innerHTML = "CONGRATULATIONS!";
          document.getElementById("best-results").innerHTML = "You did them all in one day!";
          document.body.removeChild(parent);
          changeColor();
        }
      }

      function exportGoals() {
        var text = document.getElementById("exportArea");
        text.value = "";
        var bigArray = document.getElementsByClassName("hfire-link");
        for(var i = 0; i < bigArray.length; i++)
          if(bigArray[i].style.color !== bigArray[i].style.backgroundColor)
          {
            var preText = bigArray[i].innerText || bigArray[i].textContent;
            text.value = text.value + preText;
            if(i < bigArray.length-1)
              text.value = text.value + "\r\n";
          }
      }

      function copyToClipboard() {
        /* Get the text field */
        var copyText = document.getElementById("exportArea");

        /* Select the text field */
        copyText.select();
        copyText.setSelectionRange(0, 99999); /*For mobile devices*/

        /* Copy the text inside the text field */
        document.execCommand("copy");

        /* Alert the copied text */
        alert("Copied the text: " + copyText.value);
      }

      function sleep(ms) {
        return new Promise(resolve => setTimeout(resolve, ms));
      }

      async function changeColor()
      {
        while(true)
        {
          await sleep(100);
          bgHue += 11.25;
          textHue += 11.25;
          if(bgHue >= 360)
            bgHue -= 360;
          if (textHue >= 360)
            textHue -= 360;
          document.body.style.backgroundColor = "hsl(" + bgHue.toString() + ", 13%, 32%)";
          document.body.style.color = "hsl(" + textHue.toString() + ", 22%, 87%)";
        }
      }

      var bgHue = 137;
      var textHue = 104;
    </script>
  </body>
</html>

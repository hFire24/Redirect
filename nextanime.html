<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>Your current anime</title>
    <link href="https://fonts.googleapis.com/css2?family=Barlow+Semi+Condensed:ital,wght@1,500;1,800&family=Barlow:ital,wght@1,900&display=swap" rel="stylesheet">
    <link href="style.css" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" type="text/css" href="csshake.css" />
    <link rel="shortcut icon" href="icons/icon.ico">
    <link rel="apple-touch-icon" href="icons/apple-touch-icon.png">
  </head>
  <body>
    <h1 id='message'>Your current anime with links</h1>
    <div class='space'>If you came here to procrastinate, watch anime for 30 seconds minimum.<br>
    <div class='space'><button class='custom-button' onclick='rollDice()'>Roll a die</button> <button class='custom-button' onclick='roll2Dice()'>Roll 2 dice</button> <button class='custom-button' onclick='rollManyDice(3)'>Roll 3 dice</button> <button class='custom-button' onclick='rollManyDice(4)'>Roll 4 dice</button> <button class='custom-button' onclick='goToTimer(false)'>Start timer</button> <button class='custom-button' onclick='openUtilities()'>Anime Watching Utilities</button></div>
    <div id='diceResults' class='space'></div>
    <div class='four-list space'>
      <a data-tooltip="Important classic" class='hfire-link' href='https://beta.crunchyroll.com/series/G8DHV7W21/dragon-ball'>1 Dragon Ball</a>
      <a data-tooltip="Long-running comedy" class='hfire-link' href='https://www.crunchyroll.com/series/GG5H5XMEP/sgt-frog'>2 Sgt. Frog</a>
      <a data-tooltip="Historical spy-themed" class='hfire-link' href='https://www.crunchyroll.com/series/G4PH0WXVJ/spy-x-family'>3 Spy x Family</a>
      <a data-tooltip="Futuristic military-themed" class='hfire-link' href='https://www.crunchyroll.com/series/G24H1N81X/lbx-girls'>4 LBX Girls</a>
      <a data-tooltip="Ghostly iyashikei" class='hfire-link' href='https://www.crunchyroll.com/series/GG5H5XEJ7/miss-shachiku-and-the-little-baby-ghost'>5 Miss Shachiku</a>
      <a data-tooltip="CGDCT" class='hfire-link' href='https://www.crunchyroll.com/series/GXJHM3P19/bocchi-the-rock'>6 Bocchi the Rock!</a>
      <a data-tooltip="Lolis" class='hfire-link' href='https://www.crunchyroll.com/series/G6NQV5WQ6/astarottes-toy'>7 Astarotte's Toy</a>
      <!--a data-tooltip="Morning iyashikei" class='hfire-link'>6 üé≤üé≤üé≤</a-->
      <a id="money" data-tooltip="ü§ë" class='hfire-link'>8 üí≤üí≤üí≤</a>
    </div>
    <div style="text-align:left;">
      <h4 class="no-space">Great for action</h4>
      <b>Long-running</b>: Dragon Ball ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê<br>
      <h4 class="no-space">Great for action and cuteness</h4>
      <b>Spy comedy</b>: Spy x Family ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê<br>
      <b>Futuristic military</b>: LBX Girls ‚≠ê‚≠ê
      <h4 class="no-space">Great for cuteness</h4>
      <b>Post-work anime</b>: Miss Shachiku and the Little Baby Ghost ‚≠ê‚≠ê‚≠ê<br>
      <b>Social anxiety</b>: Bocchi the Rock! ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê<br>
      <b>Ecchi isekai</b>: Astarotte's Toy ‚≠ê‚≠ê‚≠ê‚≠ê
      <h4 class="no-space">Great for laughs</h4>
      <b>Long-running</b>: Sgt. Frog ‚≠ê‚≠ê‚≠ê‚≠ê
    </div>
    <script>
      var diceRoll = 0;
      const rollTime = 750;
      const forbiddenNumbers = [8];
      const airingNumbers = [3, 6];
      const maxRoll = 8;
      var askToBan = false;
      var watchedFocus = true;
      var askIfWatchedFocus = false;
      let d = new Date();
      let isEvening = d.getHours() >= 16;

      function getLucky() {
        if(diceRoll === 0) {
          diceRoll = 1;
          diceResults.innerHTML = "You rolled a 1! That means it's time to put money in the special reserve!";
          shake(5, rollTime);
        }
        else if(diceRoll === 1) {
          diceRoll = 8;
          diceResults.innerHTML = "You rolled an 10! Commission someone right now, or put $100 in the special reserve. Congratulations!!!!!";
          shake(4, 4000);
        }
      }

      function rollDice() {
        if(diceRoll === 0) {
          if(askIfWatchedFocus)
            watchedFocus = confirmFocus();
          if(!watchedFocus)
            diceRoll = 4;
          else
            diceRoll = Math.ceil(Math.random() * maxRoll);
          switch(diceRoll) {
            case 1:
              diceResults.innerHTML = `You rolled a 1!`;
              break;
            case 2:
              diceResults.innerHTML = `You rolled a 2!`;
              break;
            case 3:
              diceResults.innerHTML = `You rolled a 3! Roll again or watch the latest episode.`;
              diceRoll = 0;
              break;
            case 4:
              diceResults.innerHTML = `You rolled a 4!`;
              break;
            case 5:
              diceResults.innerHTML = `You rolled a 5!` + (!isEvening ? ` Roll again.` : ``);
              break;
            case 6:
              diceResults.innerHTML = "You rolled a 6! Roll again or watch the latest episode.";
              diceRoll = 0;
              break;
            case 7:
              diceResults.innerHTML = `You rolled a 7!`;
              break;
            case 8:
              diceResults.innerHTML = `You rolled an 8! That means it's time to put money in the special reserve!`;
              break;
            default:
              diceResults.innerHTML = "You rolled an invalid number!";
              diceRoll = 0;
          }
          shake(5, rollTime);
        }
        else if(diceRoll === 8) {
          diceRoll = Math.ceil(Math.random() * 12);
          switch(diceRoll) {
            case 1:
              diceResults.innerHTML = "You rolled a 1. Put $0 in the special reserve. Whether this is a good thing or a bad thing is up to you."
              break;
            case 2:
              diceResults.innerHTML = "You rolled a 2. Put $5 in the special reserve.";
              shake(1, 200);
              break;
            case 3:
              diceResults.innerHTML = "You rolled a 3. Put $5 in the special reserve.";
              shake(1, 200);
              break;
            case 4:
              diceResults.innerHTML = "You rolled a 4. Put $5 in the special reserve.";
              shake(1, 200);
              break;
            case 5:
              diceResults.innerHTML = "You rolled a 5! Put $10 in the special reserve.";
              shake(2, 400);
              break;
            case 6:
              diceResults.innerHTML = "You rolled a 6! Put $10 in the special reserve.";
              shake(2, 400);
              break;
            case 7:
              diceResults.innerHTML = "You rolled a 7! Put $15 in the special reserve.";
              shake(2, 600);
              break;
            case 8:
              diceRoll = 2;
              diceResults.innerHTML = "You rolled an 8! Put $20 in the special reserve.";
              shake(3, 800);
              break;
            case 9:
              diceResults.innerHTML = "You rolled a 9! Put $25 in the special reserve.";
              shake(3, 1000);
              break;
            case 10:
              diceResults.innerHTML = "You rolled a 10! Put $30 in the special reserve.";
              shake(3, 1200);
              break;
            case 11:
              diceResults.innerHTML = "You rolled an 11! Put $40 in the special reserve.";
              shake(3, 1600);
              break;
            case 12:
              diceResults.innerHTML = "You rolled a 12! Commission someone right now, or put $100 in the special reserve. Congratulations!!!!!";
              shake(4, 4000);
              break;
            default:
              diceResults.innerHTML = "You rolled an invalid number!";
              shake(5, rollTime);
          }
        }
        else if(diceRoll === 5 && !isEvening) {
          diceRoll = 0;
          rollDice();
        }
        else {
          alert("Hey. Wait 30 minutes or watch one anime episode before rolling the dice again.");
        }
      }

      function roll2Dice() {
        if(diceRoll === 0) {
          if(askToBan)
            banANumber();
          if(!isEvening)
            forbiddenNumbers.push(5);
          let firstDiceRoll = Math.ceil(Math.random() * maxRoll);
          //To do: If the range has forbidden numbers only, then don't enter into the endless loop.
          while (forbiddenNumbers.includes(firstDiceRoll))
            firstDiceRoll = Math.ceil(Math.random() * maxRoll);
          let secondDiceRoll = Math.ceil(Math.random() * maxRoll);
          //To do: If the range has forbidden numbers only and the value of the first dice roll, then don't enter into the endless loop.
          while(secondDiceRoll === firstDiceRoll || forbiddenNumbers.includes(secondDiceRoll) || firstDiceRoll + secondDiceRoll === 7 && (firstDiceRoll === 1 || firstDiceRoll === 6))
            secondDiceRoll = Math.ceil(Math.random() * maxRoll);
          diceResults.innerHTML = (firstDiceRoll === 8 ? "You rolled an " : "You rolled a ") + `${firstDiceRoll} & ${secondDiceRoll}!`;
          diceRoll = 2;
          //To do: If a forbidden number has to be rolled, then a shrug emoji will be shown. ü§∑‚Äç‚ôÄÔ∏è
          let containsAN = [airingNumbers.includes(firstDiceRoll), airingNumbers.includes(secondDiceRoll)];
          if(containsAN[0] || containsAN[1])
          {
            diceRoll = 0;
            if(containsAN[0] && containsAN[1]) {
              diceResults.innerHTML += " Roll again or watch both of the latest episodes in tandem.";
              askToBan = true;
            }
            else {
              diceResults.innerHTML += " Roll again or watch the latest episode in tandem with the other episode.";
              containsAN[0] ? forbid(firstDiceRoll) : forbid(secondDiceRoll);
            }
          }
          shake(5, rollTime);
        }
        else {
          alert("Hey. Wait 1 hour or watch both anime episodes before rolling the dice again.");
        }
      }

      function rollManyDice(amount) {
        let diceArrayString = "";
        if(diceRoll === 0) {
          if(askToBan)
            banANumber();
          let diceRolls = [];
          let containsAN = [];
          for(let i = 0; i < amount; i++) {
            diceRolls.push(Math.ceil(Math.random() * maxRoll));
            while (forbiddenNumbers.includes(diceRolls[i]) || twoOfTheSameAiringNumbers(diceRolls))
              diceRolls[i] = Math.ceil(Math.random() * maxRoll);
            containsAN.push(airingNumbers.includes(diceRolls[i]));
            diceArrayString += i === amount - 1 ? "& " + diceRolls[i] + "!" : diceRolls[i] + ", ";
          }
          diceResults.innerHTML = (diceRolls[0] === 8 ? "You rolled an " : "You rolled a ") + diceArrayString;
          diceRoll = amount;
          if(containsAN.filter(x => x === true).length >= 1) {
            diceRoll = 0;
            if(containsAN.filter(x => x === true).length > 1) {
              diceResults.innerHTML += " Roll again or watch all the latest episodes.";
              askToBan = true;
            }
            else {
              diceResults.innerHTML += " Roll again or watch the latest episode.";
              forbid(diceRolls[containsAN.indexOf(true)]);
            }
          }
          shake(5, rollTime);
        }
        else {
          alert("Hey. Wait until tomorrow or watch four anime episodes to roll these four dice again.");
        }
      }

      function twoOfTheSameAiringNumbers(array) {
        for(let i = 0; i < airingNumbers.length; i++)
          if(array.filter(x => x === airingNumbers[i]).length > 1)
            return true;
        return false;
      }

      function confirmFocus() {
        askIfWatchedFocus = false;
        return confirm("Press OK if you watched X today.");
      }

      function banANumber() {
        let numberPrompt = prompt("Which number would you like to ban? Type " + listAiringNumbers(airingNumbers.length) + ".");
        let number = parseInt(numberPrompt);
        if(airingNumbers.includes(number))
          forbid(number);
        askToBan = false;
      }

      function forbid(number) {
        forbiddenNumbers.push(number);
        airingNumbers.splice(airingNumbers.indexOf(number), 1);
      }

      function listAiringNumbers(amount) {
        if(amount === 2)
          return airingNumbers[0] + " or " + airingNumbers[1];
        else {
          let airingString = "";
          for(let i = 0; i < amount; i++) {
            airingString += i === amount - 1 ? "or " + airingNumbers[i] : airingNumbers[i] + ", ";
          }
          return airingString;
        }
      }

      function openUtilities() {
        location.href = "animeutilities.html";
      }

      function goToTimer(newTab) {
        newTab ? window.open("https://cfreeze-timer.herokuapp.com") : location.href = "https://cfreeze-timer.herokuapp.com";
      }

      function shake(num, time) {
        let shake = "";
        switch(num) {
          case 1:
            shake = "shake-little";
            break;
          case 2:
            shake = "shake";
            break;
          case 3:
            shake = "shake-hard";
            break;
          case 4:
            shake = "shake-crazy";
            break;
          default:
            shake = "shake-horizontal"
            break;
        }
        diceResults.classList.add("shake-constant");
        diceResults.classList.add(shake);
        setTimeout(() => {
          diceResults.classList.remove("shake-constant");
          diceResults.classList.remove(shake);
        }, time);
      }

      var links = document.getElementsByTagName("a");

      for(let i = 0; i < links.length; i++) {
        let x = Math.floor(Math.random() * 128);
        let y = Math.floor(Math.random() * 128);
        let z = Math.floor(Math.random() * 32) + 96;
        let bgColor = "rgb(" + x + "," + y + "," + z + ")";
        if(links[i].id === "money")
          bgColor = "rgb(0,0,120)";
        links[i].style.backgroundColor = bgColor;
      }
      for(var i = 0; i < 0; i++) {
        let x = Math.floor(Math.random() * 128);
        let y = Math.floor(Math.random() * 128);
        let z = Math.floor(Math.random() * 32) + 96;
        let bgColor = "rgb(" + x + "," + y + "," + z + ")";
      }
    </script>
  </body>
</html>
